<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hiển thị dữ liệu từ URL</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            padding: 2rem;
            box-sizing: border-box;
        }
        /* Custom scrollbar for table container */
        .table-container::-webkit-scrollbar {
            height: 8px;
        }
        .table-container::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        .table-container::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 10px;
        }
        .table-container::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
    </style>
</head>
<body class="bg-gray-100 p-8">
    <div class="container mx-auto bg-white p-6 rounded-lg shadow-xl max-w-full lg:max-w-4xl">
        <h1 class="text-3xl font-bold text-gray-800 mb-6 text-center">Dữ liệu từ Google Sheets</h1>
        <div id="loading" class="text-center text-lg text-blue-600 mb-4 hidden">
            Đang tải dữ liệu...
        </div>
        <div id="error" class="text-center text-lg text-red-600 mb-4 hidden">
            Có lỗi xảy ra khi tải dữ liệu. Vui lòng thử lại sau.
        </div>
        <div class="overflow-x-auto rounded-lg shadow-md border border-gray-200 table-container">
            <table id="dataTable" class="min-w-full divide-y divide-gray-200">
                <thead class="bg-gray-50">
                    <!-- Tiêu đề bảng sẽ được thêm động tại đây -->
                </thead>
                <tbody class="bg-white divide-y divide-gray-200">
                    <!-- Dữ liệu bảng sẽ được thêm động tại đây -->
                </tbody>
            </table>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const dataUrl = 'https://script.googleusercontent.com/a/macros/5fedu.com/echo?user_content_key=AehSKLj9ctPANuL5MA7uwJtY4ZtLSqPPzQi_9W8P9atP8vScPMir-gxv4ybsOubLO-IjUSevhQWGl8VEH5-3yC96FBU-W_W_XuzHUpueaEznyIGXsd6nZ6omtIzjIONMgU44LNhbziV0bHcDU2Xj2AJOg1GJs8WU6uB_BSJ8BWgI9sc8GaUBq_STLrDtEBKRH5EjMBMYZbFddmAv3uZ5DF8UStwf7jCV0gJ83hAd84Z7MiB8HN19gDAA68yZYuIk-vcL6QXLyvoRb3roaLhyBxKZBVhqn9kqTBCeIOPoYSqCYRUZdCtldQ&lib=M3HS9hU-CtnVPMmLdACevME-OGeBxZ_N_';
            const loadingDiv = document.getElementById('loading');
            const errorDiv = document.getElementById('error');
            const dataTable = document.getElementById('dataTable');
            const tableHead = dataTable.querySelector('thead');
            const tableBody = dataTable.querySelector('tbody');

            // Hiển thị thông báo tải
            loadingDiv.classList.remove('hidden');

            fetch(dataUrl)
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    return response.json();
                })
                .then(data => {
                    loadingDiv.classList.add('hidden'); // Ẩn thông báo tải
                    if (data && data.length > 0) {
                        // Lấy các khóa từ đối tượng đầu tiên làm tiêu đề cột
                        const headers = Object.keys(data[0]);

                        // Tạo hàng tiêu đề
                        let headerRow = document.createElement('tr');
                        headers.forEach(headerText => {
                            let th = document.createElement('th');
                            th.textContent = headerText;
                            th.classList.add('px-6', 'py-3', 'text-left', 'text-xs', 'font-medium', 'text-gray-500', 'uppercase', 'tracking-wider');
                            headerRow.appendChild(th);
                        });
                        tableHead.appendChild(headerRow);

                        // Tạo các hàng dữ liệu
                        data.forEach(rowData => {
                            let tr = document.createElement('tr');
                            tr.classList.add('hover:bg-gray-50');
                            headers.forEach(headerText => {
                                let td = document.createElement('td');
                                // Đảm bảo dữ liệu được hiển thị dưới dạng chuỗi, tránh null/undefined
                                td.textContent = rowData[headerText] !== null && rowData[headerText] !== undefined ? rowData[headerText] : '';
                                td.classList.add('px-6', 'py-4', 'whitespace-nowrap', 'text-sm', 'text-gray-900');
                                tr.appendChild(td);
                            });
                            tableBody.appendChild(tr);
                        });
                    } else {
                        // Hiển thị thông báo nếu không có dữ liệu
                        errorDiv.textContent = 'Không có dữ liệu để hiển thị.';
                        errorDiv.classList.remove('hidden');
                    }
                })
                .catch(error => {
                    loadingDiv.classList.add('hidden'); // Ẩn thông báo tải
                    errorDiv.textContent = `Có lỗi xảy ra: ${error.message}. Vui lòng kiểm tra lại liên kết hoặc kết nối mạng.`;
                    errorDiv.classList.remove('hidden'); // Hiển thị thông báo lỗi
                    console.error('Error fetching data:', error);
                });
        });
    </script>
</body>
</html>
