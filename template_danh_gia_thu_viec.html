<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Phiếu Đánh Giá Hết Thử Việc</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }
        .form-container {
            max-width: 800px;
            margin: 2rem auto;
            padding: 2rem;
            background-color: #ffffff;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        input[type="text"], input[type="date"], textarea, select {
            border: 1px solid #d1d5db;
            border-radius: 8px;
            padding: 0.75rem 1rem;
            width: 100%;
            transition: border-color 0.2s;
        }
        input[type="text"]:focus, input[type="date"]:focus, textarea:focus, select:focus {
            outline: none;
            border-color: #6366f1;
            box-shadow: 0 0 0 2px rgba(99, 102, 241, 0.25);
        }
        .section-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 1rem;
            border-bottom: 2px solid #e5e7eb;
            padding-bottom: 0.5rem;
        }
        .label {
            font-weight: 500;
            color: #4b5563;
            margin-bottom: 0.5rem;
            display: block;
        }
        th, td {
            padding: 12px 24px;
        }

        /* CSS cho việc in ra khổ A4, dựa trên code bạn cung cấp */
        @media print {
            body {
                margin: 0;
                padding: 0;
                background: none;
            }
            .form-container {
                box-shadow: none !important;
                border-radius: 0 !important;
                padding: 1cm !important;
                width: 100% !important;
                max-width: none !important;
                margin: 0 auto !important;
                min-height: auto !important;
                height: auto !important;
                font-size: 0.75em;
                line-height: 1.1;
                transform: none !important;
                transform-origin: top left;
            }
            .no-print {
                display: none;
            }
            .section-title, .mb-6 {
                page-break-inside: avoid;
            }
            
            /* Tinh chỉnh cỡ chữ cho bản in */
            .form-container h1 { font-size: 1.5em !important; }
            .form-container p, .form-container span, .form-container td, .form-container th { font-size: 0.75em !important; }
            .form-container .text-xs { font-size: 0.6em !important; }
            .form-container .text-sm { font-size: 0.7em !important; }
            .form-container .text-base { font-size: 0.75em !important; }
            .form-container .text-lg { font-size: 0.8em !important; }
            .form-container .text-xl { font-size: 0.9em !important; }

            /* Đảm bảo các khối hiển thị đúng trên bản in */
            .flex-col.md\:flex-row {
                flex-direction: row !important;
            }
        }
        .hidden {
            display: none;
        }
    </style>
</head>
<body>

<div class="form-container">
    <div class="flex items-center mb-4">
        <table class="w-full">
            <tr>
                <td class="w-1/6">
                    <img src="https://drive.google.com/thumbnail?id=12VL0Dxkj5d8xwLFVRslpHdtlWd4MHF5a" alt="Company Logo" class="w-full h-auto rounded-full">
                </td>
                <td class="w-5/6">
                    <p class="font-bold text-base text-gray-800">CÔNG TY TNHH VINACHI VIỆT NAM</p>
                    <p class="text-xs text-gray-500 italic">Địa chỉ: Kim Thiều - Hương Mạc - Từ Sơn - Bắc Ninh</p>
                </td>
            </tr>
        </table>
    </div>

    <div class="flex flex-col items-center mb-2">
        <h1 class="text-xl font-bold text-gray-800 mb-1">PHIẾU ĐÁNH GIÁ NHÂN SỰ</h1>
        <p class="text-sm text-gray-500">Mã phiếu</p>
    </div>

    <form id="evaluationForm">
        <!-- Thông tin chung -->
        <div class="mb-4">
            <div class="section-title">I. Thông tin chung</div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                <div>
                    <label class="label">Mã nhân viên:</label>
                    <input type="text" name="maNhanVien" placeholder="Nhập mã nhân viên" required>
                </div>
                <div>
                    <label class="label">Họ và tên:</label>
                    <input type="text" name="hoTen" placeholder="Nhập họ tên nhân viên" required>
                </div>
                <div>
                    <label class="label">Phòng:</label>
                    <input type="text" name="phong" placeholder="Nhập tên phòng" required>
                </div>
                <div>
                    <label class="label">Vị trí:</label>
                    <input type="text" name="viTri" placeholder="Nhập vị trí" required>
                </div>
                <div>
                    <label class="label">Ngày đánh giá:</label>
                    <input type="date" name="ngayDanhGia" required>
                </div>
                <div>
                    <label class="label">Ngày hết thử việc:</label>
                    <input type="date" name="ngayHetThuViec" required>
                </div>
            </div>
        </div>

        <!-- Kết quả công việc -->
        <div class="mb-4">
            <div class="section-title">II. Đánh giá chi tiết</div>
            <p class="font-semibold text-gray-700 mb-2">A. Kết quả công việc</p>
            <table class="w-full text-left table-auto">
                <thead>
                    <tr class="bg-gray-100 text-gray-600 uppercase text-xs leading-normal">
                        <th class="py-2 px-4">Tên công việc</th>
                        <th class="py-2 px-4 text-center">Mức độ hoàn thành</th>
                        <th class="py-2 px-4">Nhận xét</th>
                    </tr>
                </thead>
                <tbody class="text-gray-600 text-sm font-light">
                    <!-- 5 mục công việc -->
                    <tr class="border-b border-gray-200">
                        <td class="py-2 px-4"><input type="text" name="tenCongViec_1" placeholder="Công việc 1"></td>
                        <td class="py-2 px-4 text-center"><select class="p-2 border rounded-md" name="hoanThanh_1"><option value="Kém">Kém</option><option value="TB">TB</option><option value="Khá" selected>Khá</option><option value="Tốt">Tốt</option><option value="Xuất sắc">Xuất sắc</option></select></td>
                        <td class="py-2 px-4"><textarea class="w-full h-8 border rounded-md p-1 text-xs" name="nhanXet_1" placeholder="Nhận xét..."></textarea></td>
                    </tr>
                    <tr class="border-b border-gray-200">
                        <td class="py-2 px-4"><input type="text" name="tenCongViec_2" placeholder="Công việc 2"></td>
                        <td class="py-2 px-4 text-center"><select class="p-2 border rounded-md" name="hoanThanh_2"><option value="Kém">Kém</option><option value="TB">TB</option><option value="Khá" selected>Khá</option><option value="Tốt">Tốt</option><option value="Xuất sắc">Xuất sắc</option></select></td>
                        <td class="py-2 px-4"><textarea class="w-full h-8 border rounded-md p-1 text-xs" name="nhanXet_2" placeholder="Nhận xét..."></textarea></td>
                    </tr>
                    <tr class="border-b border-gray-200">
                        <td class="py-2 px-4"><input type="text" name="tenCongViec_3" placeholder="Công việc 3"></td>
                        <td class="py-2 px-4 text-center"><select class="p-2 border rounded-md" name="hoanThanh_3"><option value="Kém">Kém</option><option value="TB">TB</option><option value="Khá" selected>Khá</option><option value="Tốt">Tốt</option><option value="Xuất sắc">Xuất sắc</option></select></td>
                        <td class="py-2 px-4"><textarea class="w-full h-8 border rounded-md p-1 text-xs" name="nhanXet_3" placeholder="Nhận xét..."></textarea></td>
                    </tr>
                    <tr class="border-b border-gray-200">
                        <td class="py-2 px-4"><input type="text" name="tenCongViec_4" placeholder="Công việc 4"></td>
                        <td class="py-2 px-4 text-center"><select class="p-2 border rounded-md" name="hoanThanh_4"><option value="Kém">Kém</option><option value="TB">TB</option><option value="Khá" selected>Khá</option><option value="Tốt">Tốt</option><option value="Xuất sắc">Xuất sắc</option></select></td>
                        <td class="py-2 px-4"><textarea class="w-full h-8 border rounded-md p-1 text-xs" name="nhanXet_4" placeholder="Nhận xét..."></textarea></td>
                    </tr>
                    <tr class="border-b border-gray-200">
                        <td class="py-2 px-4"><input type="text" name="tenCongViec_5" placeholder="Công việc 5"></td>
                        <td class="py-2 px-4 text-center"><select class="p-2 border rounded-md" name="hoanThanh_5"><option value="Kém">Kém</option><option value="TB">TB</option><option value="Khá" selected>Khá</option><option value="Tốt">Tốt</option><option value="Xuất sắc">Xuất sắc</option></select></td>
                        <td class="py-2 px-4"><textarea class="w-full h-8 border rounded-md p-1 text-xs" name="nhanXet_5" placeholder="Nhận xét..."></textarea></td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Thái độ - Tinh thần (Đã thay đổi thành một khối ngang) -->
        <div class="mb-4">
            <p class="font-semibold text-gray-700 mb-2">B. Thái độ - Tinh thần</p>
            <div class="flex flex-col md:flex-row gap-4 items-start md:items-center">
                <div class="w-full md:w-1/2">
                    <p class="font-medium text-sm text-gray-700 mb-2 md:mb-0">Gợi ý đánh giá:</p>
                    <ul class="list-disc list-inside text-xs text-gray-600">
                        <li>Trung thực và trách nhiệm</li>
                        <li>Chuyên cần và tuân thủ nội quy</li>
                        <li>Tác phong làm việc chuyên nghiệp</li>
                        <li>Chủ động, tự giác trong công việc</li>
                        <li>Ham học hỏi và cầu tiến</li>
                    </ul>
                </div>
                <div class="w-full md:w-1/4">
                    <label class="label">Đánh giá chung:</label>
                    <select class="p-2 border rounded-md" name="tt_danhgia">
                        <option value="Kém">Kém</option>
                        <option value="TB">TB</option>
                        <option value="Khá" selected>Khá</option>
                        <option value="Tốt">Tốt</option>
                        <option value="Xuất sắc">Xuất sắc</option>
                    </select>
                </div>
                <div class="w-full md:w-1/4">
                    <label class="label">Nhận xét:</label>
                    <textarea class="w-full h-40 border rounded-md p-2 text-xs" name="tt_nhanxet" placeholder="Vui lòng đưa ra nhận xét chi tiết về thái độ, tinh thần của nhân viên."></textarea>
                </div>
            </div>
        </div>
        
        <!-- Kiến thức - Hiểu biết (Đã thay đổi thành một khối ngang) -->
        <div class="mb-4">
            <p class="font-semibold text-gray-700 mb-2">C. Kiến thức - Hiểu biết</p>
            <div class="flex flex-col md:flex-row gap-4 items-start md:items-center">
                <div class="w-full md:w-1/2">
                    <p class="font-medium text-sm text-gray-700 mb-2 md:mb-0">Gợi ý đánh giá:</p>
                    <ul class="list-disc list-inside text-xs text-gray-600">
                        <li>Nắm vững quy trình nội bộ</li>
                        <li>Kiến thức chuyên môn và nghiệp vụ</li>
                        <li>Hiểu biết về sản phẩm/dịch vụ của công ty</li>
                        <li>Hiểu biết về khách hàng và thị trường</li>
                    </ul>
                </div>
                <div class="w-full md:w-1/4">
                    <label class="label">Đánh giá chung:</label>
                    <select class="p-2 border rounded-md" name="kt_danhgia">
                        <option value="Kém">Kém</option>
                        <option value="TB">TB</option>
                        <option value="Khá" selected>Khá</option>
                        <option value="Tốt">Tốt</option>
                        <option value="Xuất sắc">Xuất sắc</option>
                    </select>
                </div>
                <div class="w-full md:w-1/4">
                    <label class="label">Nhận xét:</label>
                    <textarea class="w-full h-40 border rounded-md p-2 text-xs" name="kt_nhanxet" placeholder="Vui lòng đưa ra nhận xét chi tiết về kiến thức và hiểu biết của nhân viên."></textarea>
                </div>
            </div>
        </div>

        <!-- Kỹ năng (Đã thay đổi thành một khối ngang) -->
        <div class="mb-4">
            <p class="font-semibold text-gray-700 mb-2">D. Kỹ năng</p>
            <div class="flex flex-col md:flex-row gap-4 items-start md:items-center">
                <div class="w-full md:w-1/2">
                    <p class="font-medium text-sm text-gray-700 mb-2 md:mb-0">Gợi ý đánh giá:</p>
                    <ul class="list-disc list-inside text-xs text-gray-600">
                        <li>Sử dụng công cụ phần mềm</li>
                        <li>Lập kế hoạch</li>
                        <li>Ứng biến & xử lý sự cố</li>
                        <li>Làm việc đa năng</li>
                        <li>Phối hợp làm việc nhóm</li>
                        <li>Giao tiếp</li>
                    </ul>
                </div>
                <div class="w-full md:w-1/4">
                    <label class="label">Đánh giá chung:</label>
                    <select class="p-2 border rounded-md" name="kn_danhgia">
                        <option value="Kém">Kém</option>
                        <option value="TB">TB</option>
                        <option value="Khá" selected>Khá</option>
                        <option value="Tốt">Tốt</option>
                        <option value="Xuất sắc">Xuất sắc</option>
                    </select>
                </div>
                <div class="w-full md:w-1/4">
                    <label class="label">Nhận xét:</label>
                    <textarea class="w-full h-40 border rounded-md p-2 text-xs" name="kn_nhanxet" placeholder="Vui lòng đưa ra nhận xét chi tiết về kỹ năng của nhân viên."></textarea>
                </div>
            </div>
        </div>

        <!-- Đánh giá tổng thể -->
        <div class="mb-4">
            <div class="section-title">III. Đánh giá tổng thể và Kết luận</div>
            <p class="font-semibold text-gray-700 mb-2">A. Đánh giá tổng thể</p>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-sm">
                <div>
                    <label class="label">Điểm mạnh:</label>
                    <textarea class="w-full h-20 border rounded-md p-2" name="diemManh" placeholder="Những điểm mạnh của nhân viên"></textarea>
                </div>
                <div>
                    <label class="label">Điểm yếu:</label>
                    <textarea class="w-full h-20 border rounded-md p-2" name="diemYeu" placeholder="Những điểm cần cải thiện và gợi ý"></textarea>
                </div>
                <div>
                    <label class="label">Đánh giá khác:</label>
                    <textarea class="w-full h-20 border rounded-md p-2" name="danhGiaKhac" placeholder="Thêm ý kiến của bạn"></textarea>
                </div>
            </div>
        </div>

        <!-- Kết luận -->
        <div class="mb-4">
            <p class="font-semibold text-gray-700 mb-2">B. Kết luận</p>
            <div class="flex flex-wrap gap-4 mb-2 text-sm">
                <div class="flex items-center">
                    <input type="radio" id="dungThuViec" name="ketLuan" value="Dừng thử việc" class="mr-2">
                    <label for="dungThuViec">Dừng thử việc</label>
                </div>
                <div class="flex items-center">
                    <input type="radio" id="giaHan" name="ketLuan" value="Gia hạn thử việc" class="mr-2">
                    <label for="giaHan">Gia hạn thử việc</label>
                </div>
                <div class="flex items-center">
                    <input type="radio" id="chinhThuc" name="ketLuan" value="Vào chính thức" class="mr-2">
                    <label for="chinhThuc">Vào chính thức</label>
                </div>
                <div class="flex items-center">
                    <input type="radio" id="chuyenViTri" name="ketLuan" value="Chuyển vị trí" class="mr-2">
                    <label for="chuyenViTri">Chuyển vị trí</label>
                </div>
            </div>
            <div class="mb-4 text-sm">
                <label class="label">Kết luận khác:</label>
                <textarea class="w-full h-12 border rounded-md p-2" name="ketLuanKhac" placeholder="Nhập kết luận khác nếu có"></textarea>
            </div>
        </div>

        <!-- Nút gửi form và thông báo -->
        <div class="flex flex-col items-center mt-4 no-print">
            <button type="submit" class="px-6 py-3 bg-indigo-600 text-white font-semibold rounded-lg shadow-md hover:bg-indigo-700 transition duration-300">
                Gửi Đánh Giá
            </button>
            <div id="statusMessage" class="mt-4 text-center"></div>
            <button id="printButton" onclick="window.print()" class="hidden mt-4 px-6 py-3 bg-blue-600 text-white font-semibold rounded-lg shadow-md hover:bg-blue-700 transition duration-300 no-print">
                In ra PDF
            </button>
        </div>
    </form>

    <!-- Chữ ký - Đã thay thế textarea bằng dòng kẻ cho in ấn -->
    <div class="section-title mt-8">IV. Xác nhận của các bên</div>
    <div class="grid grid-cols-1 md:grid-cols-3 gap-8 text-center mt-6 text-sm">
        <div>
            <p class="font-bold mb-1">Quản lý trực tiếp</p>
            <p class="text-gray-500 italic mb-2 text-xs">(Ký, ghi rõ họ tên)</p>
            <div class="h-10 border-b border-gray-300 mx-12"></div>
            <p class="label mt-2">Ý kiến:</p>
            <div class="h-16 border-b border-gray-300 mx-4"></div>
        </div>
        <div>
            <p class="font-bold mb-1">HCNS</p>
            <p class="text-gray-500 italic mb-2 text-xs">(Ký, ghi rõ họ tên)</p>
            <div class="h-10 border-b border-gray-300 mx-12"></div>
            <p class="label mt-2">Ý kiến:</p>
            <div class="h-16 border-b border-gray-300 mx-4"></div>
        </div>
        <div>
            <p class="font-bold mb-1">Ban Giám Đốc</p>
            <p class="text-gray-500 italic mb-2 text-xs">(Ký, ghi rõ họ tên)</p>
            <div class="h-10 border-b border-gray-300 mx-12"></div>
            <p class="label mt-2">Ý kiến:</p>
            <div class="h-16 border-b border-gray-300 mx-4"></div>
        </div>
    </div>
</div>

<script>
    document.getElementById('evaluationForm').addEventListener('submit', function(event) {
        event.preventDefault();

        const form = event.target;
        const statusMessage = document.getElementById('statusMessage');
        const printButton = document.getElementById('printButton');

        // Reset messages and button visibility
        statusMessage.innerHTML = '';
        printButton.classList.add('hidden');

        // Validation for "Kết quả công việc"
        const tenCongViecInputs = [
            document.querySelector('input[name="tenCongViec_1"]'),
            document.querySelector('input[name="tenCongViec_2"]'),
            document.querySelector('input[name="tenCongViec_3"]'),
            document.querySelector('input[name="tenCongViec_4"]'),
            document.querySelector('input[name="tenCongViec_5"]')
        ];
        const hasOneJobEntry = tenCongViecInputs.some(input => input.value.trim() !== '');
        if (!hasOneJobEntry) {
            statusMessage.innerHTML = '<span class="text-red-600">Vui lòng điền ít nhất một mục trong phần Kết quả công việc.</span>';
            return;
        }

        // Validation for "Đánh giá tổng thể"
        const diemManh = document.querySelector('textarea[name="diemManh"]').value.trim();
        const diemYeu = document.querySelector('textarea[name="diemYeu"]').value.trim();
        if (diemManh === '' || diemYeu === '') {
            statusMessage.innerHTML = '<span class="text-red-600">Vui lòng điền đầy đủ Điểm mạnh và Điểm yếu.</span>';
            return;
        }

        // Validation for "Kết luận"
        const ketLuanRadios = document.querySelectorAll('input[name="ketLuan"]');
        const isKetLuanSelected = Array.from(ketLuanRadios).some(radio => radio.checked);
        if (!isKetLuanSelected) {
            statusMessage.innerHTML = '<span class="text-red-600">Vui lòng chọn một mục trong phần Kết luận.</span>';
            return;
        }

        const formData = new FormData(form);
        const scriptUrl = 'https://script.google.com/macros/s/AKfycbzusqFgRd0QpsBc47qUTrlb1dxWo2cS674Hi5wQa06uzWlLGi6aUegBq-L7X8oA77M/exec'; 

        statusMessage.innerHTML = '<span class="text-indigo-500">Đang gửi dữ liệu...</span>';

        // Fake fetch to simulate sending data
        setTimeout(() => {
            statusMessage.innerHTML = '<span class="text-green-600">Gửi đánh giá thành công!</span>';
            printButton.classList.remove('hidden');
            // Reset form fields but not status message or print button
            // form.reset(); 
        }, 1000);
    });
</script>

</body>
</html>
